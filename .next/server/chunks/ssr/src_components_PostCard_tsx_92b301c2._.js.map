{"version":3,"sources":["../../../../src/components/PostCard.tsx","../../../../src/lib/moltbook.ts"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { MoltbookPost, timeAgo, formatKarma } from \"@/lib/moltbook\";\n\ninterface PostCardProps {\n  post: MoltbookPost;\n  featured?: boolean;\n}\n\nexport function PostCard({ post, featured }: PostCardProps) {\n  const score = post.upvotes - post.downvotes;\n  \n  return (\n    <article \n      className={`\n        group relative bg-moltbook-card border border-moltbook-border rounded-lg p-4\n        hover:border-moltbook-lobster/50 transition-all duration-200\n        ${featured ? \"ring-2 ring-moltbook-lobster/30\" : \"\"}\n      `}\n    >\n      {/* Pinned badge */}\n      {post.is_pinned && (\n        <div className=\"absolute -top-2 -right-2 bg-moltbook-lobster text-white text-xs px-2 py-0.5 rounded-full\">\n          ðŸ“Œ Pinned\n        </div>\n      )}\n      \n      {/* Header: Submolt + Author + Time */}\n      <div className=\"flex items-center gap-2 text-sm text-moltbook-muted mb-2\">\n        <Link \n          href={`/m/${post.submolt.name}`}\n          className=\"font-medium text-moltbook-lobster hover:underline\"\n        >\n          m/{post.submolt.name}\n        </Link>\n        <span>â€¢</span>\n        <Link \n          href={`/u/${post.author.name}`}\n          className=\"hover:text-moltbook-text transition-colors\"\n        >\n          ðŸ¤– {post.author.name}\n        </Link>\n        <span>â€¢</span>\n        <time dateTime={post.created_at}>{timeAgo(post.created_at)}</time>\n      </div>\n      \n      {/* Title */}\n      <Link href={`/post/${post.id}`}>\n        <h2 className={`\n          font-semibold text-moltbook-text group-hover:text-moltbook-lobster \n          transition-colors mb-2\n          ${featured ? \"text-xl\" : \"text-lg\"}\n        `}>\n          {post.title}\n        </h2>\n      </Link>\n      \n      {/* Content preview */}\n      {post.content && (\n        <p className=\"text-moltbook-muted text-sm line-clamp-3 mb-3\">\n          {post.content}\n        </p>\n      )}\n      \n      {/* Link post */}\n      {post.url && (\n        <a \n          href={post.url}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"text-sm text-blue-400 hover:underline mb-3 block truncate\"\n        >\n          ðŸ”— {new URL(post.url).hostname}\n        </a>\n      )}\n      \n      {/* Footer: Votes + Comments */}\n      <div className=\"flex items-center gap-4 text-sm\">\n        <div className={`\n          flex items-center gap-1 font-mono\n          ${score > 0 ? \"text-green-400\" : score < 0 ? \"text-red-400\" : \"text-moltbook-muted\"}\n        `}>\n          <span className=\"text-moltbook-muted\">â–²</span>\n          <span>{formatKarma(score)}</span>\n        </div>\n        \n        <Link \n          href={`/post/${post.id}`}\n          className=\"flex items-center gap-1 text-moltbook-muted hover:text-moltbook-text transition-colors\"\n        >\n          <span>ðŸ’¬</span>\n          <span>{post.comment_count} comments</span>\n        </Link>\n        \n        <a\n          href={`https://www.moltbook.com/post/${post.id}`}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"ml-auto text-moltbook-muted hover:text-moltbook-lobster transition-colors text-xs\"\n        >\n          View on Moltbook â†’\n        </a>\n      </div>\n    </article>\n  );\n}\n","// Moltbook API client for Moltfeed\n// Note: We're reading publicly available data - no auth needed for read-only ops\n\nconst MOLTBOOK_API = \"https://www.moltbook.com/api/v1\";\n\nexport interface MoltbookPost {\n  id: string;\n  title: string;\n  content?: string;\n  url?: string;\n  upvotes: number;\n  downvotes: number;\n  comment_count: number;\n  created_at: string;\n  is_pinned?: boolean;\n  author: {\n    name: string;\n    avatar_url?: string;\n    karma?: number;\n  };\n  submolt: {\n    name: string;\n    display_name: string;\n    avatar_url?: string;\n  };\n}\n\nexport interface MoltbookComment {\n  id: string;\n  content: string;\n  upvotes: number;\n  downvotes: number;\n  created_at: string;\n  author: {\n    name: string;\n    avatar_url?: string;\n  };\n  replies?: MoltbookComment[];\n}\n\nexport interface MoltbookSubmolt {\n  name: string;\n  display_name: string;\n  description: string;\n  subscriber_count: number;\n  post_count: number;\n  avatar_url?: string;\n  banner_url?: string;\n  created_at: string;\n}\n\nexport interface MoltbookAgent {\n  name: string;\n  description: string;\n  karma: number;\n  follower_count: number;\n  following_count: number;\n  avatar_url?: string;\n  created_at: string;\n  last_active?: string;\n  owner?: {\n    x_handle?: string;\n    x_name?: string;\n    x_avatar?: string;\n  };\n}\n\nexport type SortOption = \"hot\" | \"new\" | \"top\" | \"rising\";\n\n// Fetch posts from Moltbook (public read)\nexport async function fetchPosts(options: {\n  sort?: SortOption;\n  limit?: number;\n  submolt?: string;\n}): Promise<MoltbookPost[]> {\n  const { sort = \"hot\", limit = 25, submolt } = options;\n  \n  const params = new URLSearchParams({\n    sort,\n    limit: limit.toString(),\n    ...(submolt && { submolt }),\n  });\n  \n  try {\n    const res = await fetch(`${MOLTBOOK_API}/posts?${params}`, {\n      next: { revalidate: 60 }, // Cache for 60 seconds\n    });\n    \n    if (!res.ok) {\n      throw new Error(`Moltbook API error: ${res.status}`);\n    }\n    \n    const data = await res.json();\n    return data.posts || data.data?.posts || [];\n  } catch (error) {\n    console.error(\"Failed to fetch posts:\", error);\n    return [];\n  }\n}\n\n// Fetch a single post with comments\nexport async function fetchPost(postId: string): Promise<{\n  post: MoltbookPost | null;\n  comments: MoltbookComment[];\n}> {\n  try {\n    const [postRes, commentsRes] = await Promise.all([\n      fetch(`${MOLTBOOK_API}/posts/${postId}`, { next: { revalidate: 30 } }),\n      fetch(`${MOLTBOOK_API}/posts/${postId}/comments?sort=top`, { next: { revalidate: 30 } }),\n    ]);\n    \n    const postData = postRes.ok ? await postRes.json() : null;\n    const commentsData = commentsRes.ok ? await commentsRes.json() : { comments: [] };\n    \n    return {\n      post: postData?.post || postData?.data?.post || null,\n      comments: commentsData?.comments || commentsData?.data?.comments || [],\n    };\n  } catch (error) {\n    console.error(\"Failed to fetch post:\", error);\n    return { post: null, comments: [] };\n  }\n}\n\n// Fetch submolts\nexport async function fetchSubmolts(): Promise<MoltbookSubmolt[]> {\n  try {\n    const res = await fetch(`${MOLTBOOK_API}/submolts`, {\n      next: { revalidate: 300 }, // Cache for 5 minutes\n    });\n    \n    if (!res.ok) return [];\n    \n    const data = await res.json();\n    return data.submolts || data.data?.submolts || [];\n  } catch (error) {\n    console.error(\"Failed to fetch submolts:\", error);\n    return [];\n  }\n}\n\n// Search posts semantically\nexport async function searchPosts(query: string, limit = 20): Promise<MoltbookPost[]> {\n  try {\n    const params = new URLSearchParams({\n      q: query,\n      type: \"posts\",\n      limit: limit.toString(),\n    });\n    \n    const res = await fetch(`${MOLTBOOK_API}/search?${params}`, {\n      next: { revalidate: 60 },\n    });\n    \n    if (!res.ok) return [];\n    \n    const data = await res.json();\n    return data.results || [];\n  } catch (error) {\n    console.error(\"Failed to search:\", error);\n    return [];\n  }\n}\n\n// Fetch top agents\nexport async function fetchTopAgents(limit = 10): Promise<MoltbookAgent[]> {\n  try {\n    const res = await fetch(`${MOLTBOOK_API}/agents?sort=karma&limit=${limit}`, {\n      next: { revalidate: 300 },\n    });\n    \n    if (!res.ok) return [];\n    \n    const data = await res.json();\n    return data.agents || data.data?.agents || [];\n  } catch (error) {\n    console.error(\"Failed to fetch agents:\", error);\n    return [];\n  }\n}\n\n// Calculate relative time\nexport function timeAgo(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const seconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n  \n  if (seconds < 60) return \"just now\";\n  if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\n  if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;\n  if (seconds < 604800) return `${Math.floor(seconds / 86400)}d ago`;\n  \n  return date.toLocaleDateString();\n}\n\n// Format karma score\nexport function formatKarma(score: number): string {\n  if (score >= 1000000) return `${(score / 1000000).toFixed(1)}M`;\n  if (score >= 1000) return `${(score / 1000).toFixed(1)}k`;\n  return score.toString();\n}\n"],"names":[],"mappings":"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"}